<h1>IRB Terminal</h1>

<form id="irbForm" action="/execute" method="post" data-turbo="false">
  <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
  <input type="hidden" name="code" id="codeInput">
</form>

<pre><code>
eval(%w(ingage_big                                                                                                         _logo   _asciiart_coord=[[[
10,4],[15,4],[18,                                                                                                        5],[7,5]  ,[25,15],[4,18],[3,
19],[1,19]],[[10,                                                                                                         4],[15,4  ],[17,5],[8,5],[1,
3],[4,10],[31,6],  [1                                                                                                       0,5],[   9,5],[1,5],[9,5]]
,[[10,4],[15,4],[  16,5                                                                                                      ],[9,   5],[1,3],[4,10],[
4,21],[1,18],[3,5  ],[9,      5],                                                                                            [1,5],  [9,5]],[[6,11],[2
,24],[5,5],[5,15]  ,[17,4],[14,3                                                                                             ]    ,  [1,18],[3,19],[1,
19]],[[10,4],[15,  4],[13, 5],[12                                                                                                     ,5],[7,12],[3,4]
,[14,3],[1,3],[13  ,2],     [3,5                                                                                                     ],[9,5],[1,5],[9,
5]],[[10,4],[15,4  ],[1                       1                                                                                       ,5],[3,5],[6,5],
[7,12],[3,21],[1,  18                         ],                                                                                      [3,5],[9,5],[1,5
],[9,5]],[[10,4],                            [7,2                                                                                      0],[10,5],[7,5]
,[11,4],[7,3],[19                           ,18],[3                                                                                     ,19],[1,19]],[
[10,4],[1,2],[20                           ,3],[10,5]                                                                                    ,[3,3],[2,5],
[2,3],[6,4],[7,3                          ],[1,4],[6,3]                                                                                     ,[5,3],[13
,2],[3,5],[29,5]                         ],[[10,5],[8,3],                                                                                  [9,4],[10,5
],[4,3],[2,5],[2                        ,3],[6,4],[7,3],[1,4                                                                                ],[6,3],[5
,18],[3,5],[29,                        5]],[[8,6],[10,4],[6,4],                                                                                [9,7],[
4,3],[2,5],[2,3                       ],[6,4],[7,3],[1,17],[1,18],                                                                          [3,5],[7,1
5],[7,5]],[[6,                       3],[1,4],[11,4],[4,4],[8,4],[1,4                                                                     ],[3,4],[2,5
],[2,4],[5,4]                      ,[7,2],[2,4],[4,4],[6,3],[13,2],[3,5],[7,3                                                         ],[9,3],[7,5]],[
[10,4],[12,                       4],[1,5]               ,[14,4],[3,4],[2,5],[2,4],                                                           [5,4],[6
,3],[1,1                         8],[1,18],[3,5],[7,3],[      9,3],[7,5]],[[10,4],[14       ,6]                                              ,[16,4],[
3,4],[2,5]                       ,[2,4],[5,4],[5,3],[1,1],[1,  4],[4,4],[6,18],[3,5],  [7,3],[9,3],[7,5]],[[10,4],[                         13,4],[1,4
],[14,4],[9,5                   ],[11,4],[4,3],[4,17],[4,4],[5,4],[5,5],[7,15],[7,5]],[[10,4],[10,6],[3,5],[12,4],[9                       ,5],[8,7],[
3,2],[6,                         4],[4,4                         ],[8,4],[7,4],[4,5]                         ,[26,8]],                    [[9,5],[7,8]
,[5,8],                          [8,  4],[9,5] ,[11,4],[1  1,17],[  1,5        ],  [9,5],[2  ,5],[29,5  ]],[[0   ,0]                    ],[[7,6]],[[4,
3],[6,2]],[[3                       ,2],[10,2]],[[2,2],[12,2]],[[3,  2],[10,2]],  [[4,2],[7,3]],[[6  ,7],[85,10]]                       ,[[5,10],[7,24
],[17,16],[3    ,4]                ,[7,4],[11, 5],    [1    6,16],[  3,4],[13,15  ]],[[3,2      ],  [   9,2],[2,4  ],[           24,3]    ,[10,4],[22,
2],[3,4],[19   ,     3          ],  [9,4],[22,2],[        8,3],[17,  3]],[[1,2],[ 11,2],[2,     2]  ,[29,2],[6,3] ,[2           5     ,   2],[1,3],[24
,3],[5,3],[   2  5,2]  ,       [5,  3],[23,3]],[[1,1]     ,[12,2],  [2,2],[30,2],  [3,3],[2 7,2],   [1,2],[26,2], [3,3        ]  ,[27  ,   2],[3,3],[2
7,2],],[[1,   2 ],[11   ,2     ],[2 ,4],[29,2],[1,3]    ,[28,2],[1 ,2],[13,3],[11, 2],[1,3],[2    8,2],[2,3],[29  ,2]],      [   [1,4] ,   [9,2],[4,3]
,[11,6],[12   , 1]  ,[1  ,   2],[11,    8],[10,2],[1,2],[10,7],[  10,2],[1,2],[11,8  ],[10,2],[1,2],[12,8],[1   1,2]],[[   3,  2], [9  ,   2],[6,1],[1
0,1],[5,2],   [1 1,1],[1  ,  2],[9,3],[7,                     1],[9,2],[1,5],[3,3],[18,                    2],[1,2],[9,3   ]  ,[7,1], [9   ,2],[1,2],[
11,1],[8,1],  [10,2]],[   [   3,2],[9,2],[6,1],[10,1],[5,3],[10,1],[1,2],[9,2],[8,1],[9,2],[3,5],[22,2],[1,2],[9,2],[8,1   ]   ,[9,2],[1  ,2],[12,8],[
11,2]],[[3,2   ],[9,2  ],     [6,1],[10,1],[7,1],[10,1],[1,2],[9,2],[8,1],[9,2],[1,4],[9,5],[11,2],[1,2],[9,2],[8,1],[9,  2  ],  [1,2],   [29,3]],[[3,
2],[9,2],[6,   1],[1  0,  1]  ,[7,1],[10,1],[1,2],[9,3],[7,1],[9,2],[1,3],[9,1],[4,2],[10,2],[1,2],[9,3],[7,1],[9,2],[1   ,2  ],  [24,5  ]],[[3,2],[9,
2],[6,1],[10,   1  ]  ,  [5,   3],[10,1],[1,2],[11,8],[10,2],[1,2],[9,2],[4,2],[10,2],[1,2],[11,8],[10,2],[1,2],[13,11]   ,[7  ,  2 ]]   ,[[2,3],[10,2
],[3,3],[10,3]   ,    [  3,3   ],[10,1],[2,2],[28,2],[1,2],[10,5],[13,2],[1,2],[28,2],[1,2],[31,2]],[[1,3],[11,3],[1,2]  ,[14  ,   2]   ,[2,2],[10,2],
[3,2],[27,2],[1   ,2   ]  ,[   30,1],[1,2],[27,2],[2,2],[30,2]],[[1,1],[15,1],[1,2],[14,2],[2,2],[9,3],[4,3],[25,2],[1,  3]   ,   [2   9,2],[1,3],[25,
2],[3,2],[28,2]]    ,[  [      1,2],[13,2],[1,2],[14,2],[2,2],[8,2],[9 ,3],[  22,2],[3,2],[14,2],[11,2],[5,3],[22,2],[      4   ,3   ],[24,3]],[[1,16]
,[4,4],[6,4],[4,2]    ,[7,2],  [13,3],[1,3],[1,5],[9,2],[5,3],[8,3]   ,[1,3],[  6,2],[11,3],[1,3],[1,5],[9,2],[7,3],[1   7,4]],[    [41,7],[11,8],[6,4
],[8,2],[8,8],[7,5],    [10,8   ],[6,4],[8,2],[10,7],[2,8]],[[57,3],[7,5],[13,2],[36,3],[7,5],[13,2]],[[57,2],[25,2],[  37,2],    [25,2]],[[57,3],[22,
3],[38,3],[22,3]],[[59          ,2],[18,4],[42,2],[18,4]],[[60 , 5     ] ,[    9 ,  5],[47,5],[9,5]],[[64,11],[55,11]]          ];ingage_big_logo_asci
iart_coord.each{|line|put        s(line.map{|space,sharp|32.  c h  r     *sp ac e +      '#'*sharp}.join)}###########        #########################
##############################   ############################                         ### ##########################   ###############################
###############################   ##################################################################################   ###############################
################################   ################################################################################   ################################
#################################   #################################       #####################################    #################################
##################################    ################################        ##################################    ##################################
####################################    #################################     #################################   ####################################
######################################    ###################################################################    #####################################
########################################     ##############################################################    #######################################
###########################################     ########## ###############################  ############     #########################################
#############################################      ###### #  ####### ##### ########### #  ############    ############################################
###############################################        ###  # ## ##  # ###    ####  ### #  #######     ###############################################
#############################################              #  ## ## ## #  #### ## #   ######             #############################################
##################################              #               ##  ##### ## ##### ###              #               ##################################
############################                   ##        #####                           ###                              ############################
##########################       ##########    #         ###################################         #    ############       #########################
########################     ######           #           ##################################         #             #######     #######################
#######################    ####              ##           #################################           #                  ###    ######################
#####################    ####                ##             #############################             #                    ##    #####################
#####################   ####                 #          ##     #######################      #          #                    ##    ####################
####################    ###                 ##           ###                             ###           ##                   ###    ###################
###################    ###                 ##            #########                 #########           ##                    ###   ###################
###################    ###                 ##            ###################################            #                    ###   ###################
###################    ##                  #              ##################################             #                   ###    ##################
###################    ##                 ##              #################################              #                   ###    ##################
###################    ##                ##               #################################               #                  ###    ##################
###################    ##                ##               #################################               #                  ###    ##################
###################    ###               #                #################################                #                 ###    ##################
###################    ###              ###                ###############################                                   ###    ##################
###################    ###             #####               ###############################                  #                ###    ##################
###################    ##                 ####             ###############################               ##                  ###    #############)*"")
</code></pre>

<!-- 预定义的完整 ruby 代码，放在隐藏的 textarea 里 -->
<textarea id="presetCode" style="display: none;">
eval(%w(ingage_big                                                                                                         _logo   _asciiart_coord=[[[
10,4],[15,4],[18,                                                                                                        5],[7,5]  ,[25,15],[4,18],[3,
19],[1,19]],[[10,                                                                                                         4],[15,4  ],[17,5],[8,5],[1,
3],[4,10],[31,6],  [1                                                                                                       0,5],[   9,5],[1,5],[9,5]]
,[[10,4],[15,4],[  16,5                                                                                                      ],[9,   5],[1,3],[4,10],[
4,21],[1,18],[3,5  ],[9,      5],                                                                                            [1,5],  [9,5]],[[6,11],[2
,24],[5,5],[5,15]  ,[17,4],[14,3                                                                                             ]    ,  [1,18],[3,19],[1,
19]],[[10,4],[15,  4],[13, 5],[12                                                                                                     ,5],[7,12],[3,4]
,[14,3],[1,3],[13  ,2],     [3,5                                                                                                     ],[9,5],[1,5],[9,
5]],[[10,4],[15,4  ],[1                       1                                                                                       ,5],[3,5],[6,5],
[7,12],[3,21],[1,  18                         ],                                                                                      [3,5],[9,5],[1,5
],[9,5]],[[10,4],                            [7,2                                                                                      0],[10,5],[7,5]
,[11,4],[7,3],[19                           ,18],[3                                                                                     ,19],[1,19]],[
[10,4],[1,2],[20                           ,3],[10,5]                                                                                    ,[3,3],[2,5],
[2,3],[6,4],[7,3                          ],[1,4],[6,3]                                                                                     ,[5,3],[13
,2],[3,5],[29,5]                         ],[[10,5],[8,3],                                                                                  [9,4],[10,5
],[4,3],[2,5],[2                        ,3],[6,4],[7,3],[1,4                                                                                ],[6,3],[5
,18],[3,5],[29,                        5]],[[8,6],[10,4],[6,4],                                                                                [9,7],[
4,3],[2,5],[2,3                       ],[6,4],[7,3],[1,17],[1,18],                                                                          [3,5],[7,1
5],[7,5]],[[6,                       3],[1,4],[11,4],[4,4],[8,4],[1,4                                                                     ],[3,4],[2,5
],[2,4],[5,4]                      ,[7,2],[2,4],[4,4],[6,3],[13,2],[3,5],[7,3                                                         ],[9,3],[7,5]],[
[10,4],[12,                       4],[1,5]               ,[14,4],[3,4],[2,5],[2,4],                                                           [5,4],[6
,3],[1,1                         8],[1,18],[3,5],[7,3],[      9,3],[7,5]],[[10,4],[14       ,6]                                              ,[16,4],[
3,4],[2,5]                       ,[2,4],[5,4],[5,3],[1,1],[1,  4],[4,4],[6,18],[3,5],  [7,3],[9,3],[7,5]],[[10,4],[                         13,4],[1,4
],[14,4],[9,5                   ],[11,4],[4,3],[4,17],[4,4],[5,4],[5,5],[7,15],[7,5]],[[10,4],[10,6],[3,5],[12,4],[9                       ,5],[8,7],[
3,2],[6,                         4],[4,4                         ],[8,4],[7,4],[4,5]                         ,[26,8]],                    [[9,5],[7,8]
,[5,8],                          [8,  4],[9,5] ,[11,4],[1  1,17],[  1,5        ],  [9,5],[2  ,5],[29,5  ]],[[0   ,0]                    ],[[7,6]],[[4,
3],[6,2]],[[3                       ,2],[10,2]],[[2,2],[12,2]],[[3,  2],[10,2]],  [[4,2],[7,3]],[[6  ,7],[85,10]]                       ,[[5,10],[7,24
],[17,16],[3    ,4]                ,[7,4],[11, 5],    [1    6,16],[  3,4],[13,15  ]],[[3,2      ],  [   9,2],[2,4  ],[           24,3]    ,[10,4],[22,
2],[3,4],[19   ,     3          ],  [9,4],[22,2],[        8,3],[17,  3]],[[1,2],[ 11,2],[2,     2]  ,[29,2],[6,3] ,[2           5     ,   2],[1,3],[24
,3],[5,3],[   2  5,2]  ,       [5,  3],[23,3]],[[1,1]     ,[12,2],  [2,2],[30,2],  [3,3],[2 7,2],   [1,2],[26,2], [3,3        ]  ,[27  ,   2],[3,3],[2
7,2],],[[1,   2 ],[11   ,2     ],[2 ,4],[29,2],[1,3]    ,[28,2],[1 ,2],[13,3],[11, 2],[1,3],[2    8,2],[2,3],[29  ,2]],      [   [1,4] ,   [9,2],[4,3]
,[11,6],[12   , 1]  ,[1  ,   2],[11,    8],[10,2],[1,2],[10,7],[  10,2],[1,2],[11,8  ],[10,2],[1,2],[12,8],[1   1,2]],[[   3,  2], [9  ,   2],[6,1],[1
0,1],[5,2],   [1 1,1],[1  ,  2],[9,3],[7,                     1],[9,2],[1,5],[3,3],[18,                    2],[1,2],[9,3   ]  ,[7,1], [9   ,2],[1,2],[
11,1],[8,1],  [10,2]],[   [   3,2],[9,2],[6,1],[10,1],[5,3],[10,1],[1,2],[9,2],[8,1],[9,2],[3,5],[22,2],[1,2],[9,2],[8,1   ]   ,[9,2],[1  ,2],[12,8],[
11,2]],[[3,2   ],[9,2  ],     [6,1],[10,1],[7,1],[10,1],[1,2],[9,2],[8,1],[9,2],[1,4],[9,5],[11,2],[1,2],[9,2],[8,1],[9,  2  ],  [1,2],   [29,3]],[[3,
2],[9,2],[6,   1],[1  0,  1]  ,[7,1],[10,1],[1,2],[9,3],[7,1],[9,2],[1,3],[9,1],[4,2],[10,2],[1,2],[9,3],[7,1],[9,2],[1   ,2  ],  [24,5  ]],[[3,2],[9,
2],[6,1],[10,   1  ]  ,  [5,   3],[10,1],[1,2],[11,8],[10,2],[1,2],[9,2],[4,2],[10,2],[1,2],[11,8],[10,2],[1,2],[13,11]   ,[7  ,  2 ]]   ,[[2,3],[10,2
],[3,3],[10,3]   ,    [  3,3   ],[10,1],[2,2],[28,2],[1,2],[10,5],[13,2],[1,2],[28,2],[1,2],[31,2]],[[1,3],[11,3],[1,2]  ,[14  ,   2]   ,[2,2],[10,2],
[3,2],[27,2],[1   ,2   ]  ,[   30,1],[1,2],[27,2],[2,2],[30,2]],[[1,1],[15,1],[1,2],[14,2],[2,2],[9,3],[4,3],[25,2],[1,  3]   ,   [2   9,2],[1,3],[25,
2],[3,2],[28,2]]    ,[  [      1,2],[13,2],[1,2],[14,2],[2,2],[8,2],[9 ,3],[  22,2],[3,2],[14,2],[11,2],[5,3],[22,2],[      4   ,3   ],[24,3]],[[1,16]
,[4,4],[6,4],[4,2]    ,[7,2],  [13,3],[1,3],[1,5],[9,2],[5,3],[8,3]   ,[1,3],[  6,2],[11,3],[1,3],[1,5],[9,2],[7,3],[1   7,4]],[    [41,7],[11,8],[6,4
],[8,2],[8,8],[7,5],    [10,8   ],[6,4],[8,2],[10,7],[2,8]],[[57,3],[7,5],[13,2],[36,3],[7,5],[13,2]],[[57,2],[25,2],[  37,2],    [25,2]],[[57,3],[22,
3],[38,3],[22,3]],[[59          ,2],[18,4],[42,2],[18,4]],[[60 , 5     ] ,[    9 ,  5],[47,5],[9,5]],[[64,11],[55,11]]          ];ingage_big_logo_asci
iart_coord.each{|line|put        s(line.map{|space,sharp|32.  c h  r     *sp ac e +      '#'*sharp}.join)}###########        #########################
##############################   ############################                         ### ##########################   ###############################
###############################   ##################################################################################   ###############################
################################   ################################################################################   ################################
#################################   #################################       #####################################    #################################
##################################    ################################        ##################################    ##################################
####################################    #################################     #################################   ####################################
######################################    ###################################################################    #####################################
########################################     ##############################################################    #######################################
###########################################     ########## ###############################  ############     #########################################
#############################################      ###### #  ####### ##### ########### #  ############    ############################################
###############################################        ###  # ## ##  # ###    ####  ### #  #######     ###############################################
#############################################              #  ## ## ## #  #### ## #   ######             #############################################
##################################              #               ##  ##### ## ##### ###              #               ##################################
############################                   ##        #####                           ###                              ############################
##########################       ##########    #         ###################################         #    ############       #########################
########################     ######           #           ##################################         #             #######     #######################
#######################    ####              ##           #################################           #                  ###    ######################
#####################    ####                ##             #############################             #                    ##    #####################
#####################   ####                 #          ##     #######################      #          #                    ##    ####################
####################    ###                 ##           ###                             ###           ##                   ###    ###################
###################    ###                 ##            #########                 #########           ##                    ###   ###################
###################    ###                 ##            ###################################            #                    ###   ###################
###################    ##                  #              ##################################             #                   ###    ##################
###################    ##                 ##              #################################              #                   ###    ##################
###################    ##                ##               #################################               #                  ###    ##################
###################    ##                ##               #################################               #                  ###    ##################
###################    ###               #                #################################                #                 ###    ##################
###################    ###              ###                ###############################                                   ###    ##################
###################    ###             #####               ###############################                  #                ###    ##################
###################    ##                 ####             ###############################               ##                  ###    #############)*"")
</textarea>

<!-- 按钮 -->
<button onclick="submitCode()">Run</button>

<script>
  function submitCode() {
    const rubyCode = document.getElementById("presetCode").value;
    document.getElementById("codeInput").value = rubyCode;
    document.getElementById("irbForm").submit();
  }
</script>

<% if @output.present? %>
  <canvas id="asciiCanvas"></canvas>

  <script>
    const asciiText = `<%= j @output %>`;

    const canvas = document.getElementById('asciiCanvas');
    const context = canvas.getContext('2d');

    const fontSize = 16;
    const fontFamily = "monospace";
    const lines = asciiText.split("\n");
    const maxLineLength = Math.max(...lines.map(line => line.length));

    canvas.width = maxLineLength * fontSize * 0.6;
    canvas.height = lines.length * fontSize * 1.2;

    context.clearRect(0, 0, canvas.width, canvas.height);
    context.font = `${fontSize}px ${fontFamily}`;
    context.fillStyle = "black";

    lines.forEach((line, i) => {
      context.fillText(line, 0, (i + 1) * fontSize);
    });

    canvas.style.width = '1300vw';
    canvas.style.height = 'auto';
  </script>
<% end %>
